image:
  repository: ghcr.io/jo-hoe/gostwriter
  pullPolicy: IfNotPresent
  tag: ""

# -- Secrets to use for pulling images (for private registries)
imagePullSecrets: []
# -- Partially override the chart name
nameOverride: ""
# -- Fully override the release name
fullnameOverride: ""

# -- Number of desired pod replicas
replicaCount: 1

serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Automatically mount a ServiceAccount's API credentials
  automount: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# -- Annotations to add to the Pod
podAnnotations: {}
# -- Additional labels to add to the Pod
podLabels: {}

# -- Pod-level security context
podSecurityContext: {}
  # fsGroup: 2000

# -- Container-level security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  # -- Kubernetes Service type
  type: ClusterIP
  # -- Service port
  port: 80
  # -- Target container port exposed by the application
  targetPort: 8080

ingress:
  # -- Enable Ingress
  enabled: false
  # -- IngressClass name
  className: ""
  # -- Annotations to add to the Ingress
  annotations: {}
  # -- Ingress host definitions
  hosts:
    - host: gostwriter.local
      paths:
        - path: /
          pathType: Prefix
  # -- TLS configuration for the Ingress
  tls: []

# -- Resource requests and limits for the container
resources: {}
  # Example:
  # limits:
  #   cpu: 200m
  #   memory: 256Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# -- Node selector for Pod assignment
nodeSelector: {}

# -- Tolerations for Pod assignment
tolerations: []

# -- Affinity rules for Pod scheduling
affinity: {}

# -- Persistence for /app/data (SQLite DB and git clone cache)
persistence:
  enabled: false
  existingClaim: ""
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 1Gi

# -- Provide application configuration via file only (never env):
# By default, the chart renders the config as a Secret and mounts it at /app/config/config.yaml
configAsSecret: true
# -- Reference an existing Secret that contains a `config.yaml` key (overrides chart-generated Secret/ConfigMap)
existingConfigSecret: ""
# -- Or provide raw config.yaml content (string). Prefer helm --set-file configRaw=path/to/config.yaml
configRaw: ""

# -- Structured configuration rendered into config.yaml (used only when configRaw is empty)
server:
  # -- HTTP bind address
  address: ":8080"
  # -- Maximum time to read the entire request (headers + body)
  readTimeout: 15s
  # -- Maximum time to process and write the response for a request
  writeTimeout: 2m
  # -- Keep-alive idle timeout for connections (no effect on in-flight requests)
  idleTimeout: 60s
  # -- Max allowed upload size (e.g., 10Mi, 20MB)
  maxUploadSize: 10Mi
  # -- Number of worker goroutines processing jobs
  workerCount: 4
  # -- Directory inside the container where data is stored (DB, git cache)
  storageDir: "/app/data"
  # -- Optional static API key required via X-API-Key header
  apiKey: ""
  # -- SQLite DB path; default storageDir/gostwriter.db if empty
  databasePath: ""
  # -- Grace period on shutdown to wait for workers to finish
  shutdownGrace: 15s
  # -- Number of times to retry webhook callbacks
  callbackRetries: 3
  # -- Base backoff duration between callback retries
  callbackBackoff: 2s

llm:
  # -- Provider selection: "mock" or "aiproxy"
  provider: "mock"
  aiproxy:
    # -- Base URL for AI Proxy (OpenAI-compatible) endpoint
    baseUrl: "http://localhost:8900"
    # -- API key for the AI Proxy (optional)
    apiKey: ""
    # -- Model name to use
    model: "gpt-5"
    # -- Optional system prompt override
    systemPrompt: ""
    # -- Optional instructions prompt override
    instructions: ""
    # -- Sampling temperature
    temperature: 0
    # -- Maximum tokens for responses (0 uses provider default)
    maxTokens: 0
  mock:
    # -- Artificial delay for mock responses
    delay: 2s
    # -- Prefix added by the mock provider
    prefix: "Transcribed by Mock"

# -- Single target configuration (GitHub via REST API)
# IMPORTANT: For Kubernetes, do NOT use env expansion inside the config.
# Provide the token directly inside a Secret-backed config.yaml (via configRaw or existingConfigSecret).
target:
  # -- Target type: only "github" is supported
  type: "github"
  # -- Logical name used to address the target
  name: "docs-main"
  # -- GitHub repository owner and name
  repoOwner: "yourorg"
  repoName: "yourrepo"
  # -- Branch to use for commits
  branch: "main"
  # -- Base path in the repo where files are written
  basePath: "inbox/"
  # -- Go text/template for filename; has .Timestamp, .JobID, etc.
  filenameTemplate: '{{ .Timestamp.Format "20060102-150405" }}-{{ .JobID }}.md'
  # -- Go text/template for commit message
  commitMessageTemplate: "Add transcription {{ .JobID }}"
  # -- Commit author name used for the commit metadata
  authorName: "Gostwriter Bot"
  # -- Commit author email used for the commit metadata
  authorEmail: "bot@example.com"
  # -- Optional override for the GitHub API base URL (e.g., for GH Enterprise)
  apiBaseUrl: "https://api.github.com"
  auth:
    # -- Personal access token for GitHub REST API
    token: ""

# -- Optional Kubernetes CronJob for scheduled tasks
# This chart does not define any default job logic. Configure command/args as needed.
cronjob:
  # -- Enable rendering a CronJob resource
  enabled: false
  # -- Cron schedule (standard CRON format)
  schedule: "0 2 * * *"
  # -- Optional Kubernetes CronJob timezone (K8s v1.27+), e.g. "Europe/Berlin"
  # When set, renders .spec.timeZone in the CronJob.
  timeZone: ""
  # -- Concurrency policy: Allow | Forbid | Replace
  concurrencyPolicy: "Forbid"
  # -- Starting deadline seconds for missed schedules (omit or set to null to disable)
  startingDeadlineSeconds:
  # -- How many completed jobs to keep
  successfulJobsHistoryLimit: 1
  # -- How many failed jobs to keep
  failedJobsHistoryLimit: 1
  # -- Job backoff limit
  backoffLimit: 1
  # -- Additional labels/annotations for the CronJob
  labels: {}
  annotations: {}
  # -- Image overrides for CronJob (fallback to top-level image when empty)
  image:
    repository: ""
    tag: ""
    pullPolicy: ""
  # -- Container command/args for the CronJob container (required for actual work)
  command: []
  args: []
  # -- Optional environment variables for the CronJob container
  env: []
  # -- Optional resource requests/limits
  resources: {}