image:
  repository: ghcr.io/jo-hoe/gostwriter
  pullPolicy: IfNotPresent
  tag: ""

# -- Secrets to use for pulling images (for private registries)
imagePullSecrets: []
# -- Partially override the chart name
nameOverride: ""
# -- Fully override the release name
fullnameOverride: ""

# -- Number of desired pod replicas
replicaCount: 1

serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Automatically mount a ServiceAccount's API credentials
  automount: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# -- Annotations to add to the Pod
podAnnotations: {}
# -- Additional labels to add to the Pod
podLabels: {}

# -- Pod-level security context
podSecurityContext: {}
  # fsGroup: 2000

# -- Container-level security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  # -- Kubernetes Service type
  type: ClusterIP
  # -- Service port
  port: 80
  # -- Target container port exposed by the application
  targetPort: 8080

ingress:
  # -- Enable Ingress
  enabled: false
  # -- IngressClass name
  className: ""
  # -- Annotations to add to the Ingress
  annotations: {}
  # -- Ingress host definitions
  hosts:
    - host: gostwriter.local
      paths:
        - path: /
          pathType: Prefix
  # -- TLS configuration for the Ingress
  tls: []

# -- Resource requests and limits for the container
resources: {}
  # Example:
  # limits:
  #   cpu: 200m
  #   memory: 256Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# -- Node selector for Pod assignment
nodeSelector: {}

# -- Tolerations for Pod assignment
tolerations: []

# -- Affinity rules for Pod scheduling
affinity: {}

# -- Persistence for /app/data (SQLite DB and git clone cache)
persistence:
  enabled: false
  existingClaim: ""
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 1Gi

# -- Provide application configuration via file only (never env):
# By default, the chart renders the config as a Secret and mounts it at /app/config/config.yaml
configAsSecret: true
# -- Reference an existing Secret that contains a `config.yaml` key (overrides chart-generated Secret/ConfigMap)
existingConfigSecret: ""
# -- Or provide raw config.yaml content (string). Prefer helm --set-file configRaw=path/to/config.yaml
configRaw: ""

# -- Structured configuration rendered into config.yaml (used only when configRaw is empty)
server:
  address: ":8080"
  readTimeout: 15s
  writeTimeout: 2m
  idleTimeout: 60s
  maxUploadSize: 10Mi
  workerCount: 4
  storageDir: "/app/data"
  apiKey: ""
  databasePath: ""
  shutdownGrace: 15s
  callbackRetries: 3
  callbackBackoff: 2s

llm:
  provider: "mock"
  aiproxy:
    baseUrl: "http://localhost:8900"
    apiKey: ""
    model: "gpt-5"
    systemPrompt: ""
    instructions: ""
    temperature: 0
    maxTokens: 0
  mock:
    delay: 2s
    prefix: "Transcribed by Mock"

# -- Single target configuration (git)
# IMPORTANT: For Kubernetes, do NOT use env expansion inside the config.
# Provide the token directly inside a Secret-backed config.yaml (via configRaw or existingConfigSecret).
target:
  type: "git"
  name: "docs-main"
  repoUrl: "https://github.com/yourorg/yourrepo.git"
  branch: "main"
  basePath: "inbox/"
  filenameTemplate: '{{ .Timestamp.Format "20060102-150405" }}-{{ .JobID }}.md'
  commitMessageTemplate: "Add transcription {{ .JobID }}"
  authorName: "Gostwriter Bot"
  authorEmail: "bot@example.com"
  cloneCacheDir: ""
  auth:
    type: "basic"
    username: "git"
    token: ""

# -- Optional Kubernetes CronJob for scheduled tasks
# This chart does not define any default job logic. Configure command/args as needed.
cronjob:
  # -- Enable rendering a CronJob resource
  enabled: false
  # -- Cron schedule (standard CRON format)
  schedule: "0 2 * * *"
  # -- Optional Kubernetes CronJob timezone (K8s v1.27+), e.g. "Europe/Berlin"
  # When set, renders .spec.timeZone in the CronJob.
  timeZone: ""
  # -- Concurrency policy: Allow | Forbid | Replace
  concurrencyPolicy: "Forbid"
  # -- Starting deadline seconds for missed schedules (omit or set to null to disable)
  startingDeadlineSeconds:
  # -- How many completed jobs to keep
  successfulJobsHistoryLimit: 1
  # -- How many failed jobs to keep
  failedJobsHistoryLimit: 1
  # -- Job backoff limit
  backoffLimit: 1
  # -- Additional labels/annotations for the CronJob
  labels: {}
  annotations: {}
  # -- Image overrides for CronJob (fallback to top-level image when empty)
  image:
    repository: ""
    tag: ""
    pullPolicy: ""
  # -- Container command/args for the CronJob container (required for actual work)
  command: []
  args: []
  # -- Optional environment variables for the CronJob container
  env: []
  # -- Optional resource requests/limits
  resources: {}
